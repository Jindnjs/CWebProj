<!DOCTYPE html>
<html layout:decorate="~{layouts/layout_board}">
<div layout:fragment="content_main">

	<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>
<style>
	.error {
    border-color: red !important;
    border-width: 2px !important; /* 선을 더 굵게 설정 */
  }
</style>

	<form method="post" onsubmit="return validateForm()">
	<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
		<div class="row">
			<div class="col-md-6 mb-4">
				<input type="text" name="title" id="title" class="form-control mb-2" placeholder="제목">
				<input type="text" name="author" id="author" class="form-control" placeholder="작성자">
			</div>
			<div class="col-md-6 mb-4 d-flex justify-content-end align-items-end">
	             <a th:href="@{''+${MenuCate.boardLink}+ '/' + ${menuId} + '/update/' + ${boardId}}" type="button" class="btn btn-warning">수정</a>
			</div>
			<div class="mb-4">
				<textarea name="content" id="summernote" rows="10" ></textarea>
			</div>
			<div class="d-flex justify-content-end mb-4">
				<a th:href="@{/form2/{id}(id=${MenuCate.id})}" class="btn btn-primary me-2">취소</a>
				<input type="submit" value="저장하기" class="btn btn-primary">
			</div>
		</div>
	</form>		

<script>
      $('#summernote').summernote({
        placeholder: '내용',
        tabsize: 2,
        height: 550,
        toolbar: [
          ['style', ['style']],
          ['font', ['bold', 'underline', 'clear']],
          ['color', ['color']],
          ['para', ['ul', 'ol', 'paragraph']],
          ['table', ['table']],
          ['insert', ['link', 'picture', 'video']],
          ['view']
        ],
        callbacks: {
            onImageUpload: function(image) {
               
                   var file = image[0];
                   var reader = new FileReader();
                  reader.onloadend = function() {
                      var image = $('<img>').attr('src',  reader.result);
                         image.attr('width','50%');
                      $('#summernote').summernote("insertNode", image[0]);
                  }
                 reader.readAsDataURL(file);
              
            }
        }
      });
      
      function validateForm() {
          var isValid = true;

          if (!$('#title').val().trim()) {
              $('#title').addClass('error');
              $('#title').addClass('is-invalid');
              $('#title').attr('placeholder', '제목을 입력하세요');
              isValid = false;
          } else {
              $('#title').removeClass('error');
              $('#title').removeClass('is-invalid');
              $('#title').attr('placeholder', '제목');
          }

          if (!$('#author').val().trim()) {
              $('#author').addClass('error');
              $('#author').addClass('is-invalid');
              $('#author').attr('placeholder', '작성자를 입력하세요');
              isValid = false;
          } else {
              $('#author').removeClass('error');
              $('#author').removeClass('is-invalid');
              $('#author').attr('placeholder', '작성자');
          }

          if (!$('#summernote').val().trim()) {         
              $('.note-placeholder').text('내용을 입력하세요');
              isValid = false;
          } else {
              $('.note-placeholder').text('내용');
          }

          return isValid;
      }

      $('#postForm').on('submit', function (event) {
          if (!validateForm()) {
              event.preventDefault();
          }
      });
    </script>
</div>
</html>