<html layout:decorate="~{layouts/layout_board}">
<div layout:fragment="content_main">
<style>
.table th, .table td {
    padding: 10px; /* 셀의 패딩 */
    
}
.table th{
text-align: center;
}

.table .number-column {
    width: 40px; /* 번호 열의 너비 */
}

.table .title-column {
    width: 250px; /* 제목 열의 너비 */
    max-width: 250px; /* 제목 열의 최대 너비 */
    overflow: hidden;
   
}

.table .date-column {
    width: 150px; /* 등록일 열의 너비 */
}

.table .author-column {
    width: 120px; /* 작성자 열의 너비 */
}

.table .view-column {
    width: 100px; /* 조회 열의 너비 */
}
</style>
<h2 class="mb-3">[[${MenuCate.categoryName}]]</h2>
					    <div class="container mt-3">
					    	<div class="row justify-content-end">
					        	<div class="col-auto">
					        		<!-- =======================================================
				                    ************************************************************
				                    
				                    브레드크럼-현재 위치
				                    
				                    ************************************************************
				                    ======================================================== -->
					            	<nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
						                <ol class="breadcrumb">
						                    <li class="breadcrumb-item active">Home</li>
						                    <li class="breadcrumb-item active" aria-current="page"><span th:text="${MenuCate.menuName}"></span></li>
						                    <li class="breadcrumb-item active" aria-current="page"><span th:text="${MenuCate.categoryName}"></li>
						                </ol>
					            	</nav>
					        	</div>
					    	</div>
						</div>
						<div style="margin-bottom:10px" class=" d-flex justify-content-end" th:if="${MenuCate.id==9} or ${#authorization.expression('hasAnyRole(''ADMIN'', ''MANAGER'')')}">				        
								<a class="btn btn-primary" th:href="${MenuCate.boardLink + '/create/' + MenuCate.id}">작성</a>
							</div>
						<!-- =======================================================
				        ************************************************************
				                    
				        게시판-공지글은 class로 스타일이 지정이 안돼 inline으로 스타일 지정
				                    
				        ************************************************************
				        ======================================================== -->					
					    <table class="table ">
					        <thead>
					        <tr>
					            <th class="number-column">번호</th>
					            <th class="title-column">제목</th>
					            <th class="date-column">등록일</th>
					            <th class="author-column">작성자</th>
					            <th class="view-column">조회</th>
					        </tr>
					        </thead>
					        <tbody>

						         <tr th:each="board : ${notices}">						    

						            <td Style="background-color:#DCDCDC">공지</td>
						            <td Style="background-color:#DCDCDC" >
						            	<a class="title-link" th:href="@{'' + ${MenuCate.id} + '/detail/' + ${board.id}}" th:text="${board.title}"></a>  
						            	<span th:if="${board.commentList.size() > 0}">(<span th:text="${board.commentList.size()}"></span>)</span>
						            	</td>
						            <td Style="background-color:#DCDCDC" th:text="${#temporals.format(board.createDate, 'yyyy-MM-dd HH:mm')}"></td>
						            <td Style="background-color:#DCDCDC">
						            	<span th:if="${board.cuser == null}" th:text="${board.author}"></span>
            							<span th:unless="${board.cuser == null}" th:text="${board.cuser.cname}"></span></td>
						            <td Style="background-color:#DCDCDC" th:text="${board.viewcount}"></td>
						        </tr>

						        <tr th:each="board,loop : ${paging}"  class="normal-row" >						    

						            <td th:text="${paging.totalElements - (paging.number * paging.size) - loop.index}"></td>
						           		<td style="cursor: pointer;" th:onclick="'redirectToDetail(' + ${board.id} + ', ' + ${MenuCate.id} + ')'">
						            	<a class="title-link" th:href="@{'' + ${MenuCate.id} + '/detail/' + ${board.id}}" th:text="${board.title}"></a>  
						            	<span th:if="${board.commentList.size() > 0}">(<span th:text="${board.commentList.size()}"></span>)</span>
						            	</td>

						            <td  th:text="${#temporals.format(board.createDate, 'yyyy-MM-dd HH:mm')}"></td>
						            <td>
						             	<span th:if="${board.cuser == null}" th:text="${board.author}"></span>
            							<span th:unless="${board.cuser == null}" th:text="${board.cuser.cname}"></span>
            						</td>
						            <td  th:text="${board.viewcount}"></td>
						        </tr>     
					        </tbody>
				    	</table>
				    	
					    	<!-- =======================================================
				            ************************************************************
				                    
				            페이징 기능
				                    
				            ************************************************************
				            ======================================================== -->
						<div class="d-flex justify-content-end mt-3">
					        <form method="get" action="#" class="d-flex" style="gap: 0.1rem;">
					            <select name="searchType" class="form-select form-select-sm" aria-label="Search Type" style="width: 120px;">
					                <option value="title" selected>제목</option>
					                <option value="author">작성자</option>
					                <option value="title_author">제목+작성자</option>
					            </select>
					            <input type="text" name="query" class="form-control form-control-sm" placeholder="검색어 입력" style="width: 160px;">
					            <button type="submit" class="btn btn-primary btn-sm">검색</button>
					        </form>
					    </div>    
				           <div>
				            <div th:if="${!paging.isEmpty()}" aria-label="Page navigation">
						        <ul class="pagination justify-content-center">
						            <li class="page-item" th:classappend="${!paging.hasPrevious} ? 'disabled'">
						                <a class="page-link"
						                    th:href="@{|?page=${paging.number-1}|}" aria-label="Previous">
						                    <span>이전</span>
						                </a>
						            </li>
						            <li th:each="page: ${#numbers.sequence(0, paging.totalPages-1)}"
						            th:if="${page >= paging.number-3 and page <= paging.number+3}"
						                th:classappend="${page == paging.number} ? 'active'" 
						                class="page-item">
						                <a th:text="${page+1}" class="page-link" th:href="@{|?page=${page}|}"></a>
						            </li>
						            <li class="page-item" th:classappend="${!paging.hasNext} ? 'disabled'">
						                <a class="page-link" th:href="@{|?page=${paging.number+1}|}">
						                    <span>다음</span>
						                </a>
						            </li>
						        </ul>
						    </div> 						   
						</div>
						 
      <script th:inline="javascript">
        function redirectToDetail(boardId, menuCateId) {
            var url = '/form2/' + menuCateId + '/detail/' + boardId;
            window.location.href = url;
        }
        
        document.addEventListener("DOMContentLoaded", function() {
            const maxLength = 20; // 제목의 최대 길이 설정
            const links = document.querySelectorAll('.title-link');

            links.forEach(link => {
                if (link.textContent.length > maxLength) {
                    link.textContent = link.textContent.substring(0, maxLength) + '...';
                }
            });
        });
      </script>

</div>
</html>